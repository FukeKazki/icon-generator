<!doctype html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Alpine</title>
</head>
<body>
<main>
    <div x-data="window.data()">
        <button x-on:click="download()">生成</button>

        <svg width="114" height="114" viewBox="0 0 114 114" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect
                    x-bind:fill="icon.backgroundColor"
                    x-bind:stroke="icon.borderColor"
                    x="1.5" y="1.5" width="111" height="111" rx="23.5" stroke-width="3"
            />
            <path d="M86.7099 42.4892C86.3589 41.2369 85.675 40.1031 84.7311 39.2084C83.7605 38.2862 82.5709 37.6265 81.2746 37.2916C76.4231 36.0128 56.9861 36.0128 56.9861 36.0128C48.883 35.9206 40.782 36.3261 32.7286 37.227C31.4323 37.5866 30.2449 38.2611 29.2721 39.1903C28.3163 40.11 27.6239 41.2441 27.2623 42.4866C26.3935 47.167 25.9713 51.9193 26.0016 56.6795C25.9706 61.4354 26.3917 66.1861 27.2623 70.8723C27.6162 72.1097 28.3059 73.2386 29.2643 74.1506C30.2228 75.0625 31.4163 75.7212 32.7286 76.07C37.6447 77.3461 56.9861 77.3461 56.9861 77.3461C65.0995 77.4385 73.2109 77.033 81.2746 76.132C82.5709 75.7971 83.7605 75.1374 84.7311 74.2151C85.6869 73.3032 86.3663 72.1691 86.7073 70.9343C87.5988 66.2558 88.0323 61.5015 88.0016 56.7389C88.0686 51.9561 87.6357 47.1794 86.7099 42.4866V42.4892ZM50.8068 65.5248V47.8367L66.9784 56.6821L50.8068 65.5248Z"
                  x-bind:fill="icon.borderColor"
            />
        </svg>

        <svg width="114" height="114" viewBox="0 0 114 114" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect
                    x-bind:fill="icon.backgroundColor"
                    x-bind:stroke="icon.borderColor"
                    x="1.5" y="1.5" width="111" height="111" rx="23.5" stroke-width="3"
            />
            <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M45.2846 28.7539C48.3149 28.6144 49.281 28.5834 57 28.5834C64.719 28.5834 65.6852 28.617 68.7129 28.7539C71.7405 28.8908 73.8072 29.3739 75.6155 30.074C77.5091 30.7895 79.227 31.9081 80.6479 33.3548C82.0945 34.773 83.2105 36.4884 83.9235 38.3845C84.6262 40.1929 85.1067 42.2595 85.2462 45.282C85.3857 48.3175 85.4167 49.2836 85.4167 57C85.4167 64.719 85.3831 65.6852 85.2462 68.7155C85.1093 71.738 84.6262 73.8046 83.9235 75.613C83.2105 77.5094 82.0927 79.2276 80.6479 80.6479C79.227 82.0945 77.5091 83.2105 75.6155 83.9235C73.8072 84.6262 71.7405 85.1067 68.718 85.2462C65.6852 85.3857 64.719 85.4167 57 85.4167C49.281 85.4167 48.3149 85.3831 45.2846 85.2462C42.2621 85.1093 40.1955 84.6262 38.3871 83.9235C36.4908 83.2104 34.7726 82.0926 33.3522 80.6479C31.9065 79.2288 30.7878 77.5114 30.074 75.6155C29.3739 73.8072 28.8934 71.7405 28.7539 68.718C28.6144 65.6826 28.5834 64.7165 28.5834 57C28.5834 49.281 28.617 48.3149 28.7539 45.2872C28.8908 42.2595 29.3739 40.1929 30.074 38.3845C30.7888 36.4886 31.9084 34.7713 33.3548 33.3522C34.7731 31.9068 36.4896 30.7881 38.3845 30.074C40.1929 29.3739 42.2595 28.8934 45.282 28.7539H45.2846ZM68.483 33.8689C65.4863 33.732 64.5873 33.7035 57 33.7035C49.4128 33.7035 48.5138 33.732 45.5171 33.8689C42.7452 33.9955 41.2417 34.4579 40.2394 34.848C38.9141 35.3646 37.966 35.9769 36.9715 36.9715C36.0287 37.8887 35.3031 39.0053 34.848 40.2394C34.4579 41.2417 33.9955 42.7452 33.8689 45.5171C33.732 48.5138 33.7035 49.4128 33.7035 57C33.7035 64.5873 33.732 65.4863 33.8689 68.483C33.9955 71.2549 34.4579 72.7584 34.848 73.7607C35.3026 74.993 36.0285 76.1115 36.9715 77.0286C37.8885 77.9715 39.0071 78.6975 40.2394 79.1521C41.2417 79.5422 42.7452 80.0046 45.5171 80.1312C48.5138 80.2681 49.4102 80.2965 57 80.2965C64.5899 80.2965 65.4863 80.2681 68.483 80.1312C71.2549 80.0046 72.7584 79.5422 73.7607 79.1521C75.086 78.6355 76.034 78.0232 77.0286 77.0286C77.9715 76.1115 78.6975 74.993 79.1521 73.7607C79.5422 72.7584 80.0046 71.2549 80.1312 68.483C80.2681 65.4863 80.2965 64.5873 80.2965 57C80.2965 49.4128 80.2681 48.5138 80.1312 45.5171C80.0046 42.7452 79.5422 41.2417 79.1521 40.2394C78.6355 38.9141 78.0232 37.966 77.0286 36.9715C76.1114 36.0287 74.9948 35.3032 73.7607 34.848C72.7584 34.4579 71.2549 33.9955 68.483 33.8689V33.8689ZM53.3705 65.7601C55.3975 66.6039 57.6546 66.7178 59.7563 66.0823C61.8579 65.4468 63.6738 64.1014 64.8937 62.2758C66.1136 60.4503 66.6618 58.2578 66.4448 56.0729C66.2278 53.888 65.259 51.8462 63.7038 50.2963C62.7124 49.3055 61.5137 48.5469 60.1939 48.075C58.8741 47.6031 57.4661 47.4297 56.0713 47.5673C54.6765 47.7049 53.3295 48.15 52.1274 48.8706C50.9252 49.5913 49.8978 50.5695 49.1191 51.7348C48.3403 52.9002 47.8297 54.2237 47.6239 55.6101C47.4181 56.9965 47.5222 58.4113 47.9288 59.7526C48.3354 61.094 49.0343 62.3284 49.9752 63.3672C50.9162 64.406 52.0758 65.2233 53.3705 65.7601ZM46.6719 46.6719C48.0282 45.3156 49.6384 44.2397 51.4105 43.5056C53.1826 42.7716 55.0819 42.3938 57 42.3938C58.9182 42.3938 60.8175 42.7716 62.5896 43.5056C64.3617 44.2397 65.9719 45.3156 67.3282 46.6719C68.6845 48.0282 69.7604 49.6384 70.4944 51.4105C71.2285 53.1826 71.6063 55.0819 71.6063 57C71.6063 58.9182 71.2285 60.8175 70.4944 62.5896C69.7604 64.3617 68.6845 65.9719 67.3282 67.3282C64.589 70.0674 60.8739 71.6063 57 71.6063C53.1262 71.6063 49.4111 70.0674 46.6719 67.3282C43.9327 64.589 42.3938 60.8739 42.3938 57C42.3938 53.1262 43.9327 49.4111 46.6719 46.6719V46.6719ZM74.8457 44.569C75.1818 44.252 75.4509 43.8707 75.637 43.4478C75.8231 43.0249 75.9225 42.5689 75.9292 42.1069C75.9359 41.6449 75.8499 41.1863 75.6762 40.7581C75.5025 40.33 75.2447 39.941 74.9179 39.6143C74.5912 39.2876 74.2023 39.0297 73.7741 38.856C73.346 38.6823 72.8873 38.5963 72.4253 38.603C71.9633 38.6098 71.5074 38.7091 71.0844 38.8953C70.6615 39.0814 70.2803 39.3504 69.9632 39.6865C69.3466 40.3402 69.009 41.2084 69.0221 42.1069C69.0352 43.0054 69.398 43.8635 70.0334 44.4989C70.6688 45.1343 71.5268 45.497 72.4253 45.5101C73.3238 45.5232 74.192 45.1857 74.8457 44.569V44.569Z"
                  x-bind:fill="icon.borderColor"
            />
        </svg>

        <svg width="114" height="114" viewBox="0 0 114 114" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect
                    x-bind:fill="icon.backgroundColor"
                    x-bind:stroke="icon.borderColor"
                    x="1.5" y="1.5" width="111" height="111" rx="23.5" stroke-width="3"
            />
            <path d="M90 40.7594C87.72 41.7327 85.2707 42.3903 82.6958 42.6875C85.3526 41.1561 87.3403 38.7457 88.2879 35.9062C85.7918 37.3345 83.0599 38.3399 80.211 38.8786C78.2951 36.9081 75.7576 35.602 72.9923 35.1631C70.2269 34.7242 67.3885 35.1771 64.9178 36.4514C62.447 37.7258 60.4821 39.7503 59.3281 42.2106C58.1741 44.671 57.8956 47.4296 58.5358 50.0581C53.478 49.8134 48.53 48.547 44.0131 46.341C39.4962 44.135 35.5113 41.0387 32.317 37.253C31.2248 39.068 30.5968 41.1724 30.5968 43.4135C30.5955 45.4311 31.1113 47.4177 32.0982 49.1972C33.0852 50.9767 34.5128 52.4939 36.2545 53.6144C34.2346 53.5525 32.2593 53.0267 30.493 52.0809V52.2387C30.4928 55.0684 31.5089 57.811 33.3688 60.0011C35.2287 62.1913 37.8179 63.6941 40.6971 64.2546C38.8233 64.7431 36.8588 64.8151 34.952 64.465C35.7643 66.8998 37.3467 69.0289 39.4775 70.5543C41.6084 72.0797 44.181 72.925 46.8354 72.9719C42.3295 76.3794 36.7648 78.2278 31.0364 78.2196C30.0217 78.2199 29.0078 78.1628 28 78.0487C33.8147 81.6502 40.5833 83.5616 47.4962 83.5542C70.897 83.5542 83.6897 64.8833 83.6897 48.6902C83.6897 48.1641 83.676 47.6328 83.6515 47.1067C86.1398 45.3732 88.2877 43.2265 89.9945 40.7673L90 40.7594V40.7594Z"
                  x-bind:fill="icon.borderColor"
            />
        </svg>

        <div>
<!--            <p x-text="icon.backgroundColor"></p>-->
            <input type="color" x-model="icon.backgroundColor">
        </div>

        <div>
<!--            <p x-text="icon.borderColor"></p>-->
            <input type="color" x-model="icon.borderColor">
        </div>
    </div>
    <div class="grid"></div>
</main>
<style>
    .grid {
        display: grid;
        gap: 20px;
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
</style>
<script type="module">
    import Alpine from "https://taisukef.github.io/alpine_es/es/index.js";

    window.data = () => ({
        icon: {
            backgroundColor: '#F1E8DC',
            borderColor: '#78584F'
        },
        download() {
            const rects = document.querySelectorAll('rect')
            const paths = document.querySelectorAll('path')
            rects.forEach(rect => {
                rect.removeAttribute('x-bind:fill')
                rect.removeAttribute('x-bind:stroke')
            })

            paths.forEach(path => {
                path.removeAttribute('x-bind:fill')
            })

            const svgs = document.querySelectorAll('svg')

            if (svgs.length === 0) {
                console.log('svg is null!')
                return undefined
            }

            svgs.forEach(svg => {
                const svgData = new XMLSerializer().serializeToString(svg)
                const canvas = document.createElement('canvas')
                canvas.width = svg.width.baseVal.value
                canvas.height = svg.height.baseVal.value
                const ctx = canvas.getContext('2d')
                const image = new Image()
                image.onload = function () {
                    ctx.drawImage(image, 0, 0)
                    document.querySelector('.grid').appendChild(image)
                    // const a = document.createElement('a')
                    // a.href = canvas.toDataURL('image/png')
                    // a.setAttribute('download', 'image.png')
                    // a.dispatchEvent(new MouseEvent('click'))
                }
                image.onerror = (e) => {
                    console.error(e)
                }
                image.src = "data:image/svg+xml," + encodeURIComponent(svgData)
            })

            rects.forEach(rect => {
                rect.setAttribute('x-bind:fill', 'icon.backgroundColor')
                rect.setAttribute('x-bind:stroke', 'icon.borderColor')
            })
            paths.forEach(path => {
                path.setAttribute('x-bind:fill', 'icon.borderColor')
            })
        }
    })
    Alpine.start();
</script>
</body>
</html>